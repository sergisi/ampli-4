% !TeX spellcheck = ca
\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{ amssymb }
\usepackage{tikz}
\usepackage{float}
\usepackage[simplified]{pgf-umlcd}
\usepackage{subfiles}
\usepackage{listings}
\usepackage[lighttt]{lmodern}
\usepackage{color}
\usepackage{array}
\usepackage{textcomp}
\graphicspath{ {img/} }

\usetikzlibrary{positioning,fit,calc,arrows.meta, shapes, snakes}
%Tot això hauria d'anar en un pkg, però no sé com és fa
\newcommand*{\assignatura}[1]{\gdef\1assignatura{#1}}
\newcommand*{\grup}[1]{\gdef\3grup{#1}}
\newcommand*{\professorat}[1]{\gdef\4professorat{#1}}
\renewcommand{\title}[1]{\gdef\5title{#1}}
\renewcommand{\author}[1]{\gdef\6author{#1}}
\renewcommand{\date}[1]{\gdef\7date{#1}}
\renewcommand{\baselinestretch}{1.5}
\renewcommand{\maketitle}{ %fa el maketitle de nou
	\begin{titlepage}
		\raggedright{UNIVERSITAT DE LLEIDA \\
			Escola Politècnica Superior \\
			Grau en Enginyeria Informàtica\\
			\1assignatura\\}
		\vspace{5cm}
		\centering\huge{\5title \\}
		\vspace{3cm}
		\large{\6author} \\
		\normalsize{\3grup}
		\vfill
		Professorat : \4professorat \\
		Data : \7date
\end{titlepage}}
%Emplenar a partir d'aquí per a fer el títol : no se com es fa el package
%S'han de renombrar totes, inclús date, si un camp es deixa en blanc no apareix

\title{SpreadSheet}
\author{Ian Palacín Aliana, Quim Picó Mora, Sergi Simón Balcells}
\date{17 de Maig}
\assignatura{Ampliació de Bases de dades i Enginyeria del Programari}
\professorat{JM. Gimeno Illa}
\grup{Prelab 2}

\renewcommand{\refname}{Referències}
%Comença el document
\begin{document}
	\maketitle
	\newpage
	\section{Introducció}%ian
	\section{Disseny}
	\subsection{Diagrama UML}%InteliJ
	\subsection{LiftA2}%Sergi
	% Operació de haskell
	% La idea es treure la necessitat dels ifs en la Operation (treure la lògica del MaybeValue)
	% S'ha implementat com un double dispatch
	\subsection{Operation i el patró Strategy}%sergi
	% Template method quedava una mica estrany utilitzant liftA2
	% Strategy quedava més net
	\subsection{EitherValue}%Sergi
	% Utilitzar MaybeValue no encapsulava els errors que es poguessin generar de forma
	% dinàmica en Strategy.
	% Un malentès en el disseny de Sheet va fer fer un refactor per a EitherValue.
	% El refactor va ser senzil, ja que liftA2 es aplicable en Eithers (és un aplicatiu)
	\subsection{LazyValue a Cell}%Quim
	% Per a realitzar lazyValue en les cel·les se va fer servir el patró observable. 
	% Cada vegada que es canvia d'expressió es canvien tots els observables per cridar
	% el metode només quan es necessari
Per tal de realitzar l'avaluació de les cel·les de forma mandrosa, s'ha decidit utilitzar el patró observable. S'ha definit sobre cada cel·la la variable lazyValue, la qual s'actualitza quan es canvia l'expressió d'una cel·la. A la vegada, es propaga una notificació al llarg dels observables que depenien d'aquesta cel·la, és a dir notifica als observables de les cel·les que contenien observadors sobre la cel·la que ha canviat perquè actualitzin el seu valor. De mateixa manera, aquestes cel·les notifiquen als observables de les cel·les que contenien observadors a aquestes cel·les que contenien observadors sobre la cel·la que ha canviat... Propagant així la notificació al llarg de totes les cel·les que depenien de la cel·la que ha canviat i fent que actualitzin el seu valor.
	\subsection{Sheet}%Ian
	% La creació de les cel·les es lazy, es a dir, només es creen quan son estrictament necessaries,
	% per a evitar ocupar massa memória en sheets molt grans quan no s'utilitza la majoria de cel·les.
	% Tot i que accedir amb una Array d'arrays sembla més natural, un hashmap es molt transparent
	% per com l'utilitza l'usuari final
	\section{Problemes}
	\subsection{References}%Ian
	% References calculaba referències de la seva referència, i això donava problemes
	% per afegir observadors (quan es generava el lazyvalue)
	% Ara només retornen la primera referència
	\subsection{Equals en Operation}%Quim
	% Quan es va fer en primer lloc el template Method per a operation es va crear un mètode
	% equals. Comparar funcions es indecidible com a problema, pel que es va haver d'eliminar
En primera instància es va decidir fer ús de Template Method per a implementar la part corresponent a Operation, Sum i Mult. Però a l'hora d'implementar el mètode equals ens vam adonar que, al treballar amb funcions anònimes ens donava problemes, ja que, comparar funcions és un problema indecidible. Per tant, es va decidir canviar de metodologia i aplicar l'Strategy Method ja explicat anteriorment.
	\subsection{Sheet, put i get}%Sergi
	% Primer vam pensar que només seria necessari utilzar el "MaybeValue" com a retorn del get.
	% El problema ens va generar era que si ens portaven una casella inval·lida retornavem Empty,
	% pel que vam fer el refactor d'Either. En crear el façade i en necessitar les cells per a crear 
	% referències ens vam adonar d'haver fet malament l'anàlisi de requeriments dels mètodes,
	% pel que es va canviar a Cell i llança excepcions de NoSuchElementException quan no troba
	% la cel·la.
	% Es va pensar d'utilitzar Optional, peró llavors el put i el get tindrien diferents formes de comunicar
	% el mateix error, pel que es va recorrer a les excepcions
	\section{Conclusions}%Quim
Per la implementació d'aquesta solució s'ha fet ús de tres patrons de disseny diferents. El patró façana el qual ha permés ficar una capa que simplifica i unifica l'utilització del nostre disseny. Per altra banda el patró observador ens ha permés realitzar l'avaluació mandrosa de les cel·les de forma senzilla. També l'Strategy Method, que a falta de no poder treballar amb template method, ens ha permés seguir treballant amb funcions anònimes a Operation. I finalment el patró NullValue, que l'hem adaptat una mica substituint-lo per un EitherValue.

\end{document}

